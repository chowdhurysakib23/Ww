<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VidShare | Video Sharing Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4285f4;
            --primary-dark: #3367d6;
            --primary-light: #e8f0fe;
            --secondary: #f8f9fa;
            --accent: #ff5252;
            --success: #4caf50;
            --warning: #ff9800;
            --text: #333333;
            --text-light: #757575;
            --border: #e0e0e0;
            --shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            --shadow-hover: 0 8px 20px rgba(0, 0, 0, 0.12);
            --radius: 12px;
            --transition: all 0.3s ease;
            --admin-primary: #673ab7;
            --admin-dark: #512da8;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: var(--text);
            line-height: 1.6;
            padding-bottom: 80px; /* Space for bottom tabs */
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            margin-bottom: 20px;
            position: relative;
        }

        .platform-name {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
        }

        .auth-buttons {
            display: flex;
            gap: 10px;
        }

        .user-profile-header {
            display: flex;
            align-items: center;
            gap: 15px;
            position: relative;
        }

        .profile-picture-header {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--primary-light);
            cursor: pointer;
            transition: var(--transition);
        }

        .profile-picture-header:hover {
            border-color: var(--primary);
        }

        .profile-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow-hover);
            padding: 10px 0;
            min-width: 180px;
            z-index: 100;
            display: none;
        }

        .profile-dropdown.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .profile-dropdown-item {
            padding: 10px 20px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .profile-dropdown-item:hover {
            background: var(--secondary);
        }

        .profile-dropdown-item.logout {
            color: var(--accent);
            border-top: 1px solid var(--border);
        }

        /* Tab Navigation */
        .tab-container {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            display: flex;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            z-index: 100;
        }

        .tab {
            flex: 1;
            text-align: center;
            padding: 15px 0;
            font-weight: 500;
            color: var(--text-light);
            cursor: pointer;
            transition: var(--transition);
            border-top: 3px solid transparent;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            font-size: 0.85rem;
        }

        .tab i {
            font-size: 1.2rem;
        }

        .tab.active {
            color: var(--primary);
            border-top: 3px solid var(--primary);
        }

        /* Views */
        .view {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .view.active {
            display: block;
        }

        /* Search Bar */
        .search-container {
            margin-bottom: 20px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 12px 45px 12px 20px;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            font-size: 1rem;
            transition: var(--transition);
            background: white;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(66, 133, 244, 0.2);
        }

        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
        }

        /* Video Grid */
        .videos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        .video-card {
            background: white;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            cursor: pointer;
            position: relative;
        }

        .video-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }

        .sponsored-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background: var(--warning);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 600;
            z-index: 2;
        }

        .thumbnail-container {
            position: relative;
            width: 100%;
            padding-top: 56.25%; /* 16:9 Aspect Ratio */
            overflow: hidden;
            background-color: #f0f0f0;
        }

        .thumbnail {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .video-card:hover .thumbnail {
            transform: scale(1.05);
        }

        .video-duration {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.8rem;
        }

        .video-content {
            padding: 15px;
        }

        .video-title {
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 8px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .video-meta {
            display: flex;
            justify-content: space-between;
            color: var(--text-light);
            font-size: 0.85rem;
        }

        .video-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid var(--border);
        }

        .action-btn {
            display: flex;
            align-items: center;
            gap: 5px;
            background: none;
            border: none;
            color: var(--text-light);
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.85rem;
        }

        .action-btn:hover {
            color: var(--primary);
        }

        .action-btn.liked {
            color: var(--accent);
        }

        .action-btn.saved {
            color: var(--primary);
        }

        /* Upload Form */
        .upload-form {
            background: white;
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
            max-width: 600px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text);
        }

        .form-input {
            width: 100%;
            padding: 12px 15px;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(66, 133, 244, 0.2);
        }

        .hint-text {
            font-size: 0.85rem;
            color: var(--text-light);
            margin-top: 5px;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 25px;
        }

        .btn {
            padding: 12px 24px;
            border-radius: var(--radius);
            font-weight: 500;
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
            flex: 2;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-ghost {
            background: transparent;
            color: var(--text-light);
            border: 1px solid var(--border);
            flex: 1;
        }

        .btn-ghost:hover {
            background: var(--secondary);
            color: var(--text);
        }

        .btn-danger {
            background: var(--accent);
            color: white;
        }

        .btn-danger:hover {
            background: #e53935;
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #43a047;
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-warning:hover {
            background: #f57c00;
        }

        .btn-admin {
            background: var(--admin-primary);
            color: white;
        }

        .btn-admin:hover {
            background: var(--admin-dark);
        }

        /* Auth Forms */
        .auth-container {
            max-width: 400px;
            margin: 0 auto;
            background: white;
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow);
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border);
        }

        .auth-tab {
            flex: 1;
            text-align: center;
            padding: 10px;
            cursor: pointer;
            transition: var(--transition);
            border-bottom: 3px solid transparent;
        }

        .auth-tab.active {
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
            font-weight: 500;
        }

        .profile-container {
            background: white;
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
            max-width: 800px;
            margin: 0 auto;
        }

        .profile-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border);
        }

        .profile-picture {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--primary-light);
        }

        .profile-info h2 {
            margin-bottom: 5px;
        }

        .profile-stats {
            display: flex;
            gap: 20px;
            margin-top: 15px;
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--text-light);
        }

        .profile-edit-form {
            margin-top: 20px;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-light);
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4caf50;
            color: white;
            padding: 15px 25px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 1000;
            transform: translateX(150%);
            transition: transform 0.3s ease;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.error {
            background: #f44336;
        }

        .toast.warning {
            background: var(--warning);
        }

        /* Loading Spinner */
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: var(--radius);
            padding: 25px;
            max-width: 500px;
            width: 90%;
            box-shadow: var(--shadow);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-light);
        }

        /* Web View */
        .webview-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            z-index: 2000;
            display: none;
            flex-direction: column;
        }

        .webview-container.show {
            display: flex;
        }

        .webview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: var(--primary);
            color: white;
        }

        .webview-title {
            font-weight: 500;
        }

        .webview-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .webview-frame {
            flex: 1;
            border: none;
            width: 100%;
            height: 100%;
        }

        /* Video Detail View */
        .video-detail-container {
            background: white;
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
            max-width: 900px;
            margin: 0 auto;
        }

        .video-player-container {
            position: relative;
            width: 100%;
            padding-top: 56.25%; /* 16:9 Aspect Ratio */
            margin-bottom: 20px;
            border-radius: var(--radius);
            overflow: hidden;
            background-color: #000;
        }

        .video-player {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }

        .video-detail-content {
            margin-bottom: 30px;
        }

        .video-detail-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .video-detail-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
        }

        .video-detail-uploader {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .video-detail-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }

        .video-detail-stats {
            display: flex;
            gap: 15px;
            color: var(--text-light);
        }

        .video-detail-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .comments-section {
            margin-top: 30px;
        }

        .comments-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border);
        }

        .comment-form {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .comment-input {
            flex: 1;
            padding: 12px 15px;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            resize: none;
            min-height: 80px;
        }

        .comment-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .comments-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .comment {
            padding: 15px;
            border-radius: var(--radius);
            background: var(--secondary);
        }

        .comment-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .comment-user {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .comment-avatar {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            object-fit: cover;
        }

        .comment-date {
            font-size: 0.8rem;
            color: var(--text-light);
        }

        .comment-content {
            margin-bottom: 10px;
        }

        .comment-actions {
            display: flex;
            gap: 15px;
        }

        .comment-action {
            background: none;
            border: none;
            color: var(--text-light);
            cursor: pointer;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .comment-action:hover {
            color: var(--primary);
        }

        .replies {
            margin-top: 15px;
            padding-left: 20px;
            border-left: 2px solid var(--border);
        }

        .reply-form {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .reply-input {
            flex: 1;
            padding: 10px 12px;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            resize: none;
            min-height: 60px;
        }

        /* Admin Panel Styles */
        .admin-container {
            background: white;
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
        }

        .admin-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border);
        }

        .admin-tab {
            padding: 10px 20px;
            cursor: pointer;
            transition: var(--transition);
            border-bottom: 3px solid transparent;
        }

        .admin-tab.active {
            border-bottom: 3px solid var(--admin-primary);
            color: var(--admin-primary);
            font-weight: 500;
        }

        .admin-section {
            display: none;
        }

        .admin-section.active {
            display: block;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--primary-light);
            border-radius: var(--radius);
            padding: 20px;
            text-align: center;
        }

        .stat-card.admin {
            background: #ede7f6;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .stat-card.admin .stat-value {
            color: var(--admin-primary);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-light);
        }

        .table-container {
            overflow-x: auto;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th,
        .data-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        .data-table th {
            background: var(--secondary);
            font-weight: 600;
        }

        .data-table tr:hover {
            background: var(--secondary);
        }

        .action-cell {
            display: flex;
            gap: 5px;
        }

        /* Password Modal */
        .password-modal .modal-content {
            max-width: 400px;
        }

        .password-input {
            width: 100%;
            padding: 12px 15px;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            font-size: 1rem;
            margin-bottom: 15px;
        }

        .password-input:focus {
            outline: none;
            border-color: var(--admin-primary);
            box-shadow: 0 0 0 2px rgba(103, 58, 183, 0.2);
        }

        /* Responsive */
        @media (min-width: 768px) {
            .tab-container {
                position: static;
                box-shadow: none;
                margin-bottom: 30px;
                justify-content: center;
                background: transparent;
            }

            .tab {
                flex: none;
                padding: 10px 30px;
                border-top: none;
                border-bottom: 3px solid transparent;
                flex-direction: row;
                font-size: 1rem;
            }

            .tab.active {
                border-top: none;
                border-bottom: 3px solid var(--primary);
            }

            body {
                padding-bottom: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="platform-name">VidShare</div>
            <div class="auth-buttons">
                <button class="btn btn-ghost" id="login-btn">
                    <i class="fas fa-sign-in-alt"></i>
                    Login
                </button>
                <button class="btn btn-primary" id="register-btn">
                    <i class="fas fa-user-plus"></i>
                    Register
                </button>
                <div class="user-profile-header" id="user-profile-header" style="display: none;">
                    <img src="https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80" 
                         alt="Profile" class="profile-picture-header" id="profile-picture-header">
                    <div class="profile-dropdown" id="profile-dropdown">
                        <div class="profile-dropdown-item" id="profile-dropdown-view">
                            <i class="fas fa-user"></i>
                            <span>View Profile</span>
                        </div>
                        <div class="profile-dropdown-item" id="profile-dropdown-edit">
                            <i class="fas fa-edit"></i>
                            <span>Edit Profile</span>
                        </div>
                        <div class="profile-dropdown-item logout" id="profile-dropdown-logout">
                            <i class="fas fa-sign-out-alt"></i>
                            <span>Logout</span>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Toast Notification -->
        <div class="toast" id="toast">
            <i class="fas fa-check-circle"></i>
            <span id="toast-message">Operation completed successfully!</span>
        </div>

        <!-- Auth Modal -->
        <div class="modal" id="auth-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="auth-modal-title">Login to VidShare</h2>
                    <button class="modal-close" id="auth-modal-close">&times;</button>
                </div>
                <div class="auth-tabs">
                    <div class="auth-tab active" id="login-tab">Login</div>
                    <div class="auth-tab" id="register-tab">Register</div>
                </div>
                <form id="login-form">
                    <div class="form-group">
                        <label class="form-label" for="login-email">Email</label>
                        <input type="email" class="form-input" id="login-email" placeholder="Enter your email" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="login-password">Password</label>
                        <input type="password" class="form-input" id="login-password" placeholder="Enter your password" required>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%;">
                        <i class="fas fa-sign-in-alt"></i>
                        Login
                    </button>
                </form>
                <form id="register-form" style="display: none;">
                    <div class="form-group">
                        <label class="form-label" for="register-name">Full Name</label>
                        <input type="text" class="form-input" id="register-name" placeholder="Enter your full name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="register-email">Email</label>
                        <input type="email" class="form-input" id="register-email" placeholder="Enter your email" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="register-password">Password</label>
                        <input type="password" class="form-input" id="register-password" placeholder="Create a password" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="register-avatar">Profile Picture URL</label>
                        <input type="url" class="form-input" id="register-avatar" placeholder="https://example.com/avatar.jpg">
                        <div class="hint-text">Optional: Provide a URL for your profile picture</div>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%;">
                        <i class="fas fa-user-plus"></i>
                        Create Account
                    </button>
                </form>
            </div>
        </div>

        <!-- Admin Password Modal -->
        <div class="modal password-modal" id="admin-password-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Admin Access</h2>
                    <button class="modal-close" id="admin-password-close">&times;</button>
                </div>
                <div class="form-group">
                    <label class="form-label" for="admin-password">Enter Admin Password</label>
                    <input type="password" class="password-input" id="admin-password" placeholder="Enter admin password" required>
                </div>
                <button class="btn btn-admin" id="admin-password-submit" style="width: 100%;">
                    <i class="fas fa-lock"></i>
                    Access Admin Panel
                </button>
            </div>
        </div>

        <!-- Tab Navigation -->
        <div class="tab-container">
            <div class="tab active" data-view="home">
                <i class="fas fa-home"></i>
                <span>Home</span>
            </div>
            <div class="tab" data-view="upload" id="upload-tab">
                <i class="fas fa-upload"></i>
                <span>Upload</span>
            </div>
            <div class="tab" data-view="profile" id="profile-tab">
                <i class="fas fa-user"></i>
                <span>Profile</span>
            </div>
            <div class="tab" data-view="saved" id="saved-tab">
                <i class="fas fa-bookmark"></i>
                <span>Saved</span>
            </div>
            <div class="tab" data-view="admin" id="admin-tab">
                <i class="fas fa-cog"></i>
                <span>Admin</span>
            </div>
        </div>

        <!-- Home View -->
        <div id="home" class="view active">
            <div class="search-container">
                <input type="text" class="search-input" id="search-input" placeholder="Search videos by title...">
                <i class="fas fa-search search-icon"></i>
            </div>
            <div class="videos-grid" id="videos-container">
                <!-- Videos will be dynamically added here -->
                <div class="spinner" id="loading-spinner"></div>
            </div>
            <div id="empty-state-home" class="empty-state" style="display: none;">
                <div class="empty-state-icon">📹</div>
                <h3>No videos yet</h3>
                <p>Be the first to upload a video!</p>
            </div>
        </div>

        <!-- Upload View -->
        <div id="upload" class="view">
            <form class="upload-form" id="upload-form">
                <div class="form-group">
                    <label class="form-label" for="video-title">Video Title</label>
                    <input type="text" class="form-input" id="video-title" placeholder="Enter your video title" required>
                    <div class="hint-text">Make it catchy and descriptive</div>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="video-url">Video URL</label>
                    <input type="url" class="form-input" id="video-url" placeholder="https://example.com/video.mp4" required>
                    <div class="hint-text">The full URL to your video file (supports 4K)</div>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="thumbnail-url">Thumbnail Image URL</label>
                    <input type="url" class="form-input" id="thumbnail-url" placeholder="https://example.com/thumbnail.jpg" required>
                    <div class="hint-text">Use a 16:9 aspect ratio image for best results</div>
                </div>

                <div class="form-group">
                    <label class="form-label" for="video-duration">Video Duration</label>
                    <input type="text" class="form-input" id="video-duration" placeholder="e.g. 5:30" required>
                    <div class="hint-text">Format: MM:SS or HH:MM:SS</div>
                </div>
                
                <div class="button-group">
                    <button type="button" class="btn btn-ghost" id="clear-form">
                        <i class="fas fa-eraser"></i>
                        Clear
                    </button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-paper-plane"></i>
                        Upload Video
                    </button>
                </div>
            </form>
            
            <div id="upload-success" class="empty-state" style="display: none;">
                <div class="empty-state-icon">✅</div>
                <h3>Video Uploaded Successfully!</h3>
                <p>Your video is now visible to everyone.</p>
            </div>
        </div>

        <!-- Profile View -->
        <div id="profile" class="view">
            <div class="profile-container">
                <div class="profile-header">
                    <img src="https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80" 
                         alt="Profile Picture" class="profile-picture" id="profile-picture">
                    <div class="profile-info">
                        <h2 id="profile-name">User Name</h2>
                        <p id="profile-email">user@example.com</p>
                        <div class="profile-stats">
                            <div class="stat">
                                <div class="stat-value" id="profile-videos">0</div>
                                <div class="stat-label">Videos</div>
                            </div>
                            <div class="stat">
                                <div class="stat-value" id="profile-likes">0</div>
                                <div class="stat-label">Likes</div>
                            </div>
                            <div class="stat">
                                <div class="stat-value" id="profile-views">0</div>
                                <div class="stat-label">Views</div>
                            </div>
                        </div>
                    </div>
                </div>

                <button class="btn btn-primary" id="edit-profile-btn">
                    <i class="fas fa-edit"></i>
                    Edit Profile
                </button>

                <form class="profile-edit-form" id="profile-edit-form" style="display: none;">
                    <div class="form-group">
                        <label class="form-label" for="edit-name">Full Name</label>
                        <input type="text" class="form-input" id="edit-name" placeholder="Enter your full name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="edit-avatar">Profile Picture URL</label>
                        <input type="url" class="form-input" id="edit-avatar" placeholder="https://example.com/avatar.jpg">
                        <div class="hint-text">Provide a URL for your profile picture</div>
                    </div>
                    <div class="button-group">
                        <button type="button" class="btn btn-ghost" id="cancel-edit">
                            Cancel
                        </button>
                        <button type="submit" class="btn btn-primary">
                            Save Changes
                        </button>
                    </div>
                </form>

                <h3 style="margin: 30px 0 15px;">My Videos</h3>
                <div class="videos-grid" id="my-videos-container">
                    <!-- User's videos will be dynamically added here -->
                </div>
                <div id="empty-state-profile" class="empty-state" style="display: none;">
                    <div class="empty-state-icon">📹</div>
                    <h3>No videos uploaded yet</h3>
                    <p>Upload your first video to get started!</p>
                </div>
            </div>
        </div>

        <!-- Saved Videos View -->
        <div id="saved" class="view">
            <div class="videos-grid" id="saved-videos-container">
                <!-- Saved videos will be dynamically added here -->
            </div>
            <div id="empty-state-saved" class="empty-state" style="display: none;">
                <div class="empty-state-icon">🔖</div>
                <h3>No saved videos</h3>
                <p>Save videos you like to watch them later!</p>
            </div>
        </div>

        <!-- Admin Panel View -->
        <div id="admin" class="view">
            <div class="admin-container">
                <div class="admin-header">
                    <h2>Admin Dashboard</h2>
                    <div class="profile-stats">
                        <div class="stat">
                            <div class="stat-value" id="admin-total-users">0</div>
                            <div class="stat-label">Users</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value" id="admin-total-videos">0</div>
                            <div class="stat-label">Videos</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value" id="admin-total-views">0</div>
                            <div class="stat-label">Views</div>
                        </div>
                    </div>
                </div>

                <div class="admin-tabs">
                    <div class="admin-tab active" data-section="dashboard">Dashboard</div>
                    <div class="admin-tab" data-section="videos">Video Management</div>
                    <div class="admin-tab" data-section="users">User Management</div>
                    <div class="admin-tab" data-section="sponsor">Sponsor Videos</div>
                </div>

                <!-- Dashboard Section -->
                <div class="admin-section active" id="dashboard-section">
                    <div class="stats-grid">
                        <div class="stat-card admin">
                            <div class="stat-value" id="dashboard-total-users">0</div>
                            <div class="stat-label">Total Users</div>
                        </div>
                        <div class="stat-card admin">
                            <div class="stat-value" id="dashboard-total-videos">0</div>
                            <div class="stat-label">Total Videos</div>
                        </div>
                        <div class="stat-card admin">
                            <div class="stat-value" id="dashboard-total-views">0</div>
                            <div class="stat-label">Total Views</div>
                        </div>
                        <div class="stat-card admin">
                            <div class="stat-value" id="dashboard-total-likes">0</div>
                            <div class="stat-label">Total Likes</div>
                        </div>
                    </div>

                    <h3>Recent Activity</h3>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>User</th>
                                    <th>Action</th>
                                    <th>Video</th>
                                    <th>Time</th>
                                </tr>
                            </thead>
                            <tbody id="recent-activity">
                                <!-- Recent activity will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Video Management Section -->
                <div class="admin-section" id="videos-section">
                    <h3>All Videos</h3>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Title</th>
                                    <th>Uploader</th>
                                    <th>Views</th>
                                    <th>Likes</th>
                                    <th>Sponsored</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="admin-videos-table">
                                <!-- Videos will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- User Management Section -->
                <div class="admin-section" id="users-section">
                    <h3>All Users</h3>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Videos</th>
                                    <th>Joined</th>
                                    <th>Role</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="admin-users-table">
                                <!-- Users will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Sponsor Videos Section -->
                <div class="admin-section" id="sponsor-section">
                    <h3>Sponsor Videos</h3>
                    <p>Sponsored videos appear more frequently in users' feeds</p>
                    <div class="videos-grid" id="sponsor-videos-container">
                        <!-- Videos available for sponsorship will appear here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAvlq4cSb4mvPJi9Idr7b6E8ZZLcgdOyZU",
            authDomain: "vitube-94a69.firebaseapp.com",
            databaseURL: "https://vitube-94a69-default-rtdb.firebaseio.com",
            projectId: "vitube-94a69",
            storageBucket: "vitube-94a69.firebasestorage.app",
            messagingSenderId: "831676079189",
            appId: "1:831676079189:web:56111c7db6725218dd08dc",
            measurementId: "G-X4GB94XKWH"
        };
        
        // Admin Password
        const ADMIN_PASSWORD = "@SAKIB123456789BCBpass";
        
        // DOM Elements
        const tabs = document.querySelectorAll('.tab');
        const views = document.querySelectorAll('.view');
        const homeView = document.getElementById('home');
        const uploadView = document.getElementById('upload');
        const profileView = document.getElementById('profile');
        const savedView = document.getElementById('saved');
        const adminView = document.getElementById('admin');
        const videosContainer = document.getElementById('videos-container');
        const myVideosContainer = document.getElementById('my-videos-container');
        const savedVideosContainer = document.getElementById('saved-videos-container');
        const sponsorVideosContainer = document.getElementById('sponsor-videos-container');
        const searchInput = document.getElementById('search-input');
        const uploadForm = document.getElementById('upload-form');
        const clearFormBtn = document.getElementById('clear-form');
        const emptyStateHome = document.getElementById('empty-state-home');
        const emptyStateProfile = document.getElementById('empty-state-profile');
        const emptyStateSaved = document.getElementById('empty-state-saved');
        const uploadSuccess = document.getElementById('upload-success');
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toast-message');
        const loadingSpinner = document.getElementById('loading-spinner');
        const authModal = document.getElementById('auth-modal');
        const authModalClose = document.getElementById('auth-modal-close');
        const loginBtn = document.getElementById('login-btn');
        const registerBtn = document.getElementById('register-btn');
        const loginForm = document.getElementById('login-form');
        const registerForm = document.getElementById('register-form');
        const loginTab = document.getElementById('login-tab');
        const registerTab = document.getElementById('register-tab');
        const authModalTitle = document.getElementById('auth-modal-title');
        const profileTab = document.getElementById('profile-tab');
        const savedTab = document.getElementById('saved-tab');
        const uploadTab = document.getElementById('upload-tab');
        const adminTab = document.getElementById('admin-tab');
        const profileName = document.getElementById('profile-name');
        const profileEmail = document.getElementById('profile-email');
        const profilePicture = document.getElementById('profile-picture');
        const profilePictureHeader = document.getElementById('profile-picture-header');
        const profileVideos = document.getElementById('profile-videos');
        const profileLikes = document.getElementById('profile-likes');
        const profileViews = document.getElementById('profile-views');
        const editProfileBtn = document.getElementById('edit-profile-btn');
        const profileEditForm = document.getElementById('profile-edit-form');
        const editName = document.getElementById('edit-name');
        const editAvatar = document.getElementById('edit-avatar');
        const cancelEdit = document.getElementById('cancel-edit');
        const adminPasswordModal = document.getElementById('admin-password-modal');
        const adminPasswordInput = document.getElementById('admin-password');
        const adminPasswordSubmit = document.getElementById('admin-password-submit');
        const adminPasswordClose = document.getElementById('admin-password-close');
        const adminTabs = document.querySelectorAll('.admin-tab');
        const adminSections = document.querySelectorAll('.admin-section');
        const adminVideosTable = document.getElementById('admin-videos-table');
        const adminUsersTable = document.getElementById('admin-users-table');
        const recentActivity = document.getElementById('recent-activity');
        const dashboardTotalUsers = document.getElementById('dashboard-total-users');
        const dashboardTotalVideos = document.getElementById('dashboard-total-videos');
        const dashboardTotalViews = document.getElementById('dashboard-total-views');
        const dashboardTotalLikes = document.getElementById('dashboard-total-likes');
        const adminTotalUsers = document.getElementById('admin-total-users');
        const adminTotalVideos = document.getElementById('admin-total-videos');
        const adminTotalViews = document.getElementById('admin-total-views');
        const userProfileHeader = document.getElementById('user-profile-header');
        const profileDropdown = document.getElementById('profile-dropdown');
        const profileDropdownView = document.getElementById('profile-dropdown-view');
        const profileDropdownEdit = document.getElementById('profile-dropdown-edit');
        const profileDropdownLogout = document.getElementById('profile-dropdown-logout');
        
        // Sample data for demonstration
        let allVideos = JSON.parse(localStorage.getItem('allVideos')) || [
            {
                id: '1',
                title: 'Getting Started with Web Development',
                url: 'https://www.youtube.com/embed/dQw4w9WgXcQ',
                thumbnail: 'https://images.unsplash.com/photo-1627398242454-45a1465c2479?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
                duration: '10:25',
                uploaderId: 'user1',
                uploaderName: 'John Doe',
                uploaderAvatar: 'https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
                timestamp: Date.now() - 86400000,
                views: 125,
                likes: ['user2', 'user3'],
                saves: ['user2'],
                sponsored: true
            },
            {
                id: '2',
                title: 'The Future of AI in Everyday Life',
                url: 'https://www.youtube.com/embed/3JluqTojuME',
                thumbnail: 'https://images.unsplash.com/photo-1677442136019-21780ecad995?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
                duration: '15:42',
                uploaderId: 'user2',
                uploaderName: 'Jane Smith',
                uploaderAvatar: 'https://images.unsplash.com/photo-1494790108755-2616b612b786?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
                timestamp: Date.now() - 172800000,
                views: 89,
                likes: ['user1'],
                saves: [],
                sponsored: false
            },
            {
                id: '3',
                title: '10 Tips for Better Photography',
                url: 'https://www.youtube.com/embed/7gQuS9qT0mg',
                thumbnail: 'https://images.unsplash.com/photo-1502920917128-1aa500764cbd?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
                duration: '8:15',
                uploaderId: 'user3',
                uploaderName: 'Mike Johnson',
                uploaderAvatar: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
                timestamp: Date.now() - 259200000,
                views: 67,
                likes: ['user1', 'user2'],
                saves: ['user1'],
                sponsored: false
            }
        ];
        
        let allUsers = JSON.parse(localStorage.getItem('allUsers')) || [
            {
                id: 'user1',
                name: 'John Doe',
                email: 'john@example.com',
                avatar: 'https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
                role: 'user',
                joinDate: Date.now() - 86400000 * 30
            },
            {
                id: 'user2',
                name: 'Jane Smith',
                email: 'jane@example.com',
                avatar: 'https://images.unsplash.com/photo-1494790108755-2616b612b786?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
                role: 'user',
                joinDate: Date.now() - 86400000 * 15
            },
            {
                id: 'user3',
                name: 'Mike Johnson',
                email: 'mike@example.com',
                avatar: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
                role: 'user',
                joinDate: Date.now() - 86400000 * 7
            }
        ];
        
        let activityLog = JSON.parse(localStorage.getItem('activityLog')) || [
            {
                id: '1',
                userId: 'user1',
                userName: 'John Doe',
                action: 'uploaded a video',
                videoTitle: 'Getting Started with Web Development',
                timestamp: Date.now() - 86400000
            },
            {
                id: '2',
                userId: 'user2',
                userName: 'Jane Smith',
                action: 'liked a video',
                videoTitle: 'Getting Started with Web Development',
                timestamp: Date.now() - 172800000
            },
            {
                id: '3',
                userId: 'user3',
                userName: 'Mike Johnson',
                action: 'uploaded a video',
                videoTitle: '10 Tips for Better Photography',
                timestamp: Date.now() - 259200000
            }
        ];
        
        // Current user state
        let currentUser = null;
        let filteredVideos = [];
        let adminAccessGranted = false;
        
        // Initialize the app
        document.addEventListener('DOMContentLoaded', () => {
            // Check if user is logged in (from localStorage)
            checkAuthState();
            
            // Load initial videos
            loadVideos();
            
            // Set up event listeners
            setupEventListeners();
            
            // Save initial data to localStorage
            saveDataToStorage();
        });
        
        // Save data to localStorage
        function saveDataToStorage() {
            localStorage.setItem('allVideos', JSON.stringify(allVideos));
            localStorage.setItem('allUsers', JSON.stringify(allUsers));
            localStorage.setItem('activityLog', JSON.stringify(activityLog));
        }
        
        // Set up all event listeners
        function setupEventListeners() {
            // Tab navigation
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const targetView = tab.getAttribute('data-view');
                    
                    if (targetView === 'admin' && !adminAccessGranted) {
                        // Show password modal for admin access
                        adminPasswordModal.classList.add('show');
                        adminPasswordInput.focus();
                    } else {
                        switchView(targetView);
                    }
                });
            });
            
            // Profile dropdown
            profilePictureHeader.addEventListener('click', (e) => {
                e.stopPropagation();
                profileDropdown.classList.toggle('show');
            });
            
            profileDropdownView.addEventListener('click', () => {
                switchView('profile');
                profileDropdown.classList.remove('show');
            });
            
            profileDropdownEdit.addEventListener('click', () => {
                showEditProfileForm();
                profileDropdown.classList.remove('show');
            });
            
            profileDropdownLogout.addEventListener('click', handleLogout);
            
            // Close dropdown when clicking outside
            document.addEventListener('click', () => {
                profileDropdown.classList.remove('show');
            });
            
            // Search functionality
            searchInput.addEventListener('input', filterVideos);
            
            // Form submission
            uploadForm.addEventListener('submit', handleVideoUpload);
            
            // Clear form
            clearFormBtn.addEventListener('click', clearForm);
            
            // Auth buttons
            loginBtn.addEventListener('click', () => {
                showAuthModal('login');
            });
            
            registerBtn.addEventListener('click', () => {
                showAuthModal('register');
            });
            
            // Auth modal
            authModalClose.addEventListener('click', () => {
                authModal.classList.remove('show');
            });
            
            // Auth tabs
            loginTab.addEventListener('click', () => {
                switchAuthTab('login');
            });
            
            registerTab.addEventListener('click', () => {
                switchAuthTab('register');
            });
            
            // Auth forms
            loginForm.addEventListener('submit', handleLogin);
            registerForm.addEventListener('submit', handleRegister);
            
            // Profile
            editProfileBtn.addEventListener('click', () => {
                showEditProfileForm();
            });
            
            cancelEdit.addEventListener('click', () => {
                hideEditProfileForm();
            });
            
            profileEditForm.addEventListener('submit', handleProfileUpdate);
            
            // Admin password modal
            adminPasswordSubmit.addEventListener('click', handleAdminPassword);
            adminPasswordClose.addEventListener('click', () => {
                adminPasswordModal.classList.remove('show');
            });
            
            // Admin password input - allow Enter key
            adminPasswordInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    handleAdminPassword();
                }
            });
            
            // Admin tabs
            adminTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const targetSection = tab.getAttribute('data-section');
                    switchAdminSection(targetSection);
                });
            });
            
            // Before page unload, save data
            window.addEventListener('beforeunload', saveDataToStorage);
        }
        
        // Handle admin password submission
        function handleAdminPassword() {
            const password = adminPasswordInput.value;
            
            if (password === ADMIN_PASSWORD) {
                adminAccessGranted = true;
                adminPasswordModal.classList.remove('show');
                adminPasswordInput.value = '';
                switchView('admin');
                showToast('Admin access granted');
            } else {
                showToast('Invalid admin password', true);
                adminPasswordInput.value = '';
                adminPasswordInput.focus();
            }
        }
        
        // Check if user is logged in
        function checkAuthState() {
            const user = localStorage.getItem('currentUser');
            if (user) {
                currentUser = JSON.parse(user);
                updateUIForUser();
            } else {
                updateUIForGuest();
            }
        }
        
        // Update UI for logged in user
        function updateUIForUser() {
            // Show user profile and hide auth buttons
            userProfileHeader.style.display = 'flex';
            loginBtn.style.display = 'none';
            registerBtn.style.display = 'none';
            
            // Update header profile picture
            profilePictureHeader.src = currentUser.avatar;
            
            // Enable protected tabs
            uploadTab.style.display = 'flex';
            profileTab.style.display = 'flex';
            savedTab.style.display = 'flex';
            
            // Update profile view
            updateProfileView();
            
            // Load user's videos and saved videos
            loadUserVideos();
            loadSavedVideos();
        }
        
        // Update UI for guest
        function updateUIForGuest() {
            // Show auth buttons and hide user profile
            userProfileHeader.style.display = 'none';
            loginBtn.style.display = 'block';
            registerBtn.style.display = 'block';
            
            // Disable protected tabs
            uploadTab.style.display = 'none';
            profileTab.style.display = 'none';
            savedTab.style.display = 'none';
            
            // If on a protected view, switch to home
            if (document.querySelector('.view.active').id === 'upload' || 
                document.querySelector('.view.active').id === 'profile' ||
                document.querySelector('.view.active').id === 'saved') {
                switchView('home');
            }
        }
        
        // Show auth modal
        function showAuthModal(type) {
            authModal.classList.add('show');
            switchAuthTab(type);
        }
        
        // Switch between login and register tabs
        function switchAuthTab(type) {
            if (type === 'login') {
                loginTab.classList.add('active');
                registerTab.classList.remove('active');
                loginForm.style.display = 'block';
                registerForm.style.display = 'none';
                authModalTitle.textContent = 'Login to VidShare';
            } else {
                loginTab.classList.remove('active');
                registerTab.classList.add('active');
                loginForm.style.display = 'none';
                registerForm.style.display = 'block';
                authModalTitle.textContent = 'Create an Account';
            }
        }
        
        // Handle login
        function handleLogin(e) {
            e.preventDefault();
            
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            // Simulate authentication
            if (email && password) {
                // In a real app, this would be a Firebase Auth call
                const user = allUsers.find(u => u.email === email);
                
                if (user) {
                    currentUser = user;
                    localStorage.setItem('currentUser', JSON.stringify(user));
                    
                    // Log activity
                    logActivity(currentUser.id, currentUser.name, 'logged in', '');
                    
                    updateUIForUser();
                    authModal.classList.remove('show');
                    showToast('Login successful!');
                    
                    // Clear form
                    loginForm.reset();
                } else {
                    showToast('Invalid email or password', true);
                }
            } else {
                showToast('Please enter email and password', true);
            }
        }
        
        // Handle register
        function handleRegister(e) {
            e.preventDefault();
            
            const name = document.getElementById('register-name').value;
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;
            const avatar = document.getElementById('register-avatar').value || 'https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80';
            
            // Simulate registration
            if (name && email && password) {
                // Check if email already exists
                if (allUsers.find(u => u.email === email)) {
                    showToast('Email already registered', true);
                    return;
                }
                
                // In a real app, this would be a Firebase Auth call
                const user = {
                    id: 'user' + Math.floor(Math.random() * 1000),
                    name: name,
                    email: email,
                    avatar: avatar,
                    role: 'user',
                    joinDate: Date.now()
                };
                
                allUsers.push(user);
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(user));
                
                // Log activity
                logActivity(currentUser.id, currentUser.name, 'created an account', '');
                
                updateUIForUser();
                authModal.classList.remove('show');
                showToast('Account created successfully!');
                
                // Clear form
                registerForm.reset();
                
                // Save data
                saveDataToStorage();
            } else {
                showToast('Please fill in all required fields', true);
            }
        }
        
        // Handle logout
        function handleLogout() {
            // Log activity
            if (currentUser) {
                logActivity(currentUser.id, currentUser.name, 'logged out', '');
            }
            
            currentUser = null;
            localStorage.removeItem('currentUser');
            updateUIForGuest();
            showToast('Logged out successfully');
        }
        
        // Switch between views
        function switchView(targetView) {
            // Update active tab
            tabs.forEach(t => t.classList.remove('active'));
            document.querySelector(`.tab[data-view="${targetView}"]`).classList.add('active');
            
            // Update active view
            views.forEach(view => view.classList.remove('active'));
            document.getElementById(targetView).classList.add('active');
            
            // Hide success message when switching tabs
            uploadSuccess.style.display = 'none';
            
            // Load specific data for certain views
            if (targetView === 'profile') {
                loadUserVideos();
            } else if (targetView === 'saved') {
                loadSavedVideos();
            } else if (targetView === 'admin') {
                loadAdminDashboard();
            }
        }
        
        // Switch between admin sections
        function switchAdminSection(targetSection) {
            // Update active tab
            adminTabs.forEach(t => t.classList.remove('active'));
            document.querySelector(`.admin-tab[data-section="${targetSection}"]`).classList.add('active');
            
            // Update active section
            adminSections.forEach(section => section.classList.remove('active'));
            document.getElementById(`${targetSection}-section`).classList.add('active');
            
            // Load specific data for certain sections
            if (targetSection === 'videos') {
                loadAdminVideos();
            } else if (targetSection === 'users') {
                loadAdminUsers();
            } else if (targetSection === 'sponsor') {
                loadSponsorVideos();
            }
        }
        
        // Load and display videos
        function loadVideos() {
            // Show loading spinner
            loadingSpinner.style.display = 'block';
            
            // Simulate loading delay
            setTimeout(() => {
                // Sort videos: sponsored first, then by timestamp (newest first)
                allVideos.sort((a, b) => {
                    if (a.sponsored && !b.sponsored) return -1;
                    if (!a.sponsored && b.sponsored) return 1;
                    return b.timestamp - a.timestamp;
                });
                
                // Apply current search filter
                filterVideos();
                
                // Hide loading spinner
                loadingSpinner.style.display = 'none';
                
                // Show/hide empty state
                if (allVideos.length === 0) {
                    emptyStateHome.style.display = 'block';
                } else {
                    emptyStateHome.style.display = 'none';
                }
            }, 800);
        }
        
        // Filter videos based on search input
        function filterVideos() {
            const searchTerm = searchInput.value.toLowerCase();
            
            if (searchTerm) {
                filteredVideos = allVideos.filter(video => 
                    video.title.toLowerCase().includes(searchTerm)
                );
            } else {
                filteredVideos = [...allVideos];
            }
            
            renderVideos();
        }
        
        // Render videos to the grid
        function renderVideos() {
            videosContainer.innerHTML = '';
            
            if (filteredVideos.length === 0) {
                const noResults = document.createElement('div');
                noResults.className = 'empty-state';
                noResults.innerHTML = `
                    <div class="empty-state-icon">🔍</div>
                    <h3>No videos found</h3>
                    <p>Try adjusting your search terms</p>
                `;
                videosContainer.appendChild(noResults);
                return;
            }
            
            filteredVideos.forEach(video => {
                const isLiked = currentUser && video.likes.includes(currentUser.id);
                const isSaved = currentUser && video.saves.includes(currentUser.id);
                
                const videoCard = document.createElement('div');
                videoCard.className = 'video-card';
                videoCard.addEventListener('click', () => {
                    openWebView(video);
                });
                
                videoCard.innerHTML = `
                    ${video.sponsored ? '<div class="sponsored-badge">Sponsored</div>' : ''}
                    <div class="thumbnail-container">
                        <img class="thumbnail" src="${video.thumbnail}" alt="${video.title}" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIwIiBoZWlnaHQ9IjE4MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZTVlNWU1Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk5vIEltYWdlPC90ZXh0Pjwvc3ZnPg=='">
                        <div class="video-duration">${video.duration}</div>
                    </div>
                    <div class="video-content">
                        <h3 class="video-title">${escapeHTML(video.title)}</h3>
                        <div class="video-meta">
                            <span>${video.uploaderName}</span>
                            <span>${video.views} views</span>
                        </div>
                        <div class="video-actions">
                            <button class="action-btn ${isLiked ? 'liked' : ''}" onclick="event.stopPropagation(); handleLike('${video.id}')">
                                <i class="fas fa-heart"></i>
                                <span>${video.likes.length}</span>
                            </button>
                            <button class="action-btn ${isSaved ? 'saved' : ''}" onclick="event.stopPropagation(); handleSave('${video.id}')">
                                <i class="fas fa-bookmark"></i>
                                <span>Save</span>
                            </button>
                        </div>
                    </div>
                `;
                
                videosContainer.appendChild(videoCard);
            });
        }
        
        // Open web view for video
        function openWebView(video) {
            // Increase view count
            if (currentUser) {
                if (!video.viewedBy) {
                    video.viewedBy = [];
                }
                
                if (!video.viewedBy.includes(currentUser.id)) {
                    video.viewedBy.push(currentUser.id);
                    video.views++;
                    
                    // Log activity
                    logActivity(currentUser.id, currentUser.name, 'watched a video', video.title);
                    
                    renderVideos();
                    saveDataToStorage();
                }
            }
            
            // Set web view content
            const webviewTitle = document.getElementById('webview-title');
            const webviewFrame = document.getElementById('webview-frame');
            const webview = document.getElementById('webview');
            const webviewClose = document.getElementById('webview-close');
            
            webviewTitle.textContent = video.title;
            webviewFrame.src = video.url;
            webview.classList.add('show');
            
            // Close webview when close button is clicked
            webviewClose.onclick = () => {
                webview.classList.remove('show');
            };
        }
        
        // Handle like action
        function handleLike(videoId) {
            if (!currentUser) {
                showAuthModal('login');
                return;
            }
            
            const video = allVideos.find(v => v.id === videoId);
            if (!video) return;
            
            const userIndex = video.likes.indexOf(currentUser.id);
            
            if (userIndex === -1) {
                // Like the video
                video.likes.push(currentUser.id);
                showToast('Video liked!');
                
                // Log activity
                logActivity(currentUser.id, currentUser.name, 'liked a video', video.title);
            } else {
                // Unlike the video
                video.likes.splice(userIndex, 1);
                showToast('Video unliked');
                
                // Log activity
                logActivity(currentUser.id, currentUser.name, 'unliked a video', video.title);
            }
            
            // Update UI
            renderVideos();
            
            // Update profile stats if on profile view
            if (document.querySelector('.view.active').id === 'profile') {
                updateProfileStats();
            }
            
            // Save data
            saveDataToStorage();
        }
        
        // Handle save action
        function handleSave(videoId) {
            if (!currentUser) {
                showAuthModal('login');
                return;
            }
            
            const video = allVideos.find(v => v.id === videoId);
            if (!video) return;
            
            const userIndex = video.saves.indexOf(currentUser.id);
            
            if (userIndex === -1) {
                // Save the video
                video.saves.push(currentUser.id);
                showToast('Video saved!');
                
                // Log activity
                logActivity(currentUser.id, currentUser.name, 'saved a video', video.title);
            } else {
                // Unsave the video
                video.saves.splice(userIndex, 1);
                showToast('Video removed from saved');
                
                // Log activity
                logActivity(currentUser.id, currentUser.name, 'unsaved a video', video.title);
            }
            
            // Update UI
            renderVideos();
            
            // Update saved videos if on saved view
            if (document.querySelector('.view.active').id === 'saved') {
                loadSavedVideos();
            }
            
            // Save data
            saveDataToStorage();
        }
        
        // Handle video upload
        function handleVideoUpload(e) {
            e.preventDefault();
            
            if (!currentUser) {
                showAuthModal('login');
                return;
            }
            
            const title = document.getElementById('video-title').value.trim();
            const url = document.getElementById('video-url').value.trim();
            const thumbnail = document.getElementById('thumbnail-url').value.trim();
            const duration = document.getElementById('video-duration').value.trim();
            
            // Basic validation
            if (!title || !url || !thumbnail || !duration) {
                showToast('Please fill in all fields', true);
                return;
            }
            
            // Validate URL format
            try {
                new URL(url);
                new URL(thumbnail);
            } catch (error) {
                showToast('Please enter valid URLs', true);
                return;
            }
            
            // Create video object
            const video = {
                id: generateId(),
                title: escapeHTML(title),
                url: escapeHTML(url),
                thumbnail: escapeHTML(thumbnail),
                duration: duration,
                uploaderId: currentUser.id,
                uploaderName: currentUser.name,
                uploaderAvatar: currentUser.avatar,
                timestamp: Date.now(),
                views: 0,
                likes: [],
                saves: [],
                sponsored: false
            };
            
            // Add video to the list
            allVideos.unshift(video);
            
            // Log activity
            logActivity(currentUser.id, currentUser.name, 'uploaded a video', video.title);
            
            // Show success message
            showToast('Video uploaded successfully!');
            
            // Reset form
            uploadForm.reset();
            
            // Update UI
            loadVideos();
            
            // Save data
            saveDataToStorage();
            
            // Switch to Home tab after 2 seconds
            setTimeout(() => {
                switchView('home');
            }, 2000);
        }
        
        // Load user's videos
        function loadUserVideos() {
            if (!currentUser) return;
            
            const userVideos = allVideos.filter(video => video.uploaderId === currentUser.id);
            
            myVideosContainer.innerHTML = '';
            
            if (userVideos.length === 0) {
                emptyStateProfile.style.display = 'block';
            } else {
                emptyStateProfile.style.display = 'none';
                
                userVideos.forEach(video => {
                    const videoCard = document.createElement('div');
                    videoCard.className = 'video-card';
                    videoCard.addEventListener('click', () => {
                        openWebView(video);
                    });
                    
                    videoCard.innerHTML = `
                        ${video.sponsored ? '<div class="sponsored-badge">Sponsored</div>' : ''}
                        <div class="thumbnail-container">
                            <img class="thumbnail" src="${video.thumbnail}" alt="${video.title}" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIwIiBoZWlnaHQ9IjE4MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZTVlNWU1Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk5v IEltYWdlPC90ZXh0Pjwvc3ZnPg=='">
                            <div class="video-duration">${video.duration}</div>
                        </div>
                        <div class="video-content">
                            <h3 class="video-title">${escapeHTML(video.title)}</h3>
                            <div class="video-meta">
                                <span>${video.views} views</span>
                                <span>${video.likes.length} likes</span>
                            </div>
                            <div class="video-actions">
                                <button class="btn btn-danger" onclick="event.stopPropagation(); deleteVideo('${video.id}')">
                                    <i class="fas fa-trash"></i>
                                    Delete
                                </button>
                            </div>
                        </div>
                    `;
                    
                    myVideosContainer.appendChild(videoCard);
                });
            }
            
            // Update profile stats
            updateProfileStats();
        }
        
        // Load saved videos
        function loadSavedVideos() {
            if (!currentUser) return;
            
            const savedVideos = allVideos.filter(video => video.saves.includes(currentUser.id));
            
            savedVideosContainer.innerHTML = '';
            
            if (savedVideos.length === 0) {
                emptyStateSaved.style.display = 'block';
            } else {
                emptyStateSaved.style.display = 'none';
                
                savedVideos.forEach(video => {
                    const isLiked = video.likes.includes(currentUser.id);
                    
                    const videoCard = document.createElement('div');
                    videoCard.className = 'video-card';
                    videoCard.addEventListener('click', () => {
                        openWebView(video);
                    });
                    
                    videoCard.innerHTML = `
                        ${video.sponsored ? '<div class="sponsored-badge">Sponsored</div>' : ''}
                        <div class="thumbnail-container">
                            <img class="thumbnail" src="${video.thumbnail}" alt="${video.title}" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIwIiBoZWlnaHQ9IjE4MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZTVlNWU1Ii8+PHRleHQgeD0iNTAlIiB5PSI5MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk5vIEltYWdlPC90ZXh0Pjwvc3ZnPg=='">
                            <div class="video-duration">${video.duration}</div>
                        </div>
                        <div class="video-content">
                            <h3 class="video-title">${escapeHTML(video.title)}</h3>
                            <div class="video-meta">
                                <span>${video.uploaderName}</span>
                                <span>${video.views} views</span>
                            </div>
                            <div class="video-actions">
                                <button class="action-btn ${isLiked ? 'liked' : ''}" onclick="event.stopPropagation(); handleLike('${video.id}')">
                                    <i class="fas fa-heart"></i>
                                    <span>${video.likes.length}</span>
                                </button>
                                <button class="action-btn saved" onclick="event.stopPropagation(); handleSave('${video.id}')">
                                    <i class="fas fa-bookmark"></i>
                                    <span>Saved</span>
                                </button>
                            </div>
                        </div>
                    `;
                    
                    savedVideosContainer.appendChild(videoCard);
                });
            }
        }
        
        // Delete video
        function deleteVideo(videoId) {
            if (!confirm('Are you sure you want to delete this video?')) return;
            
            const videoIndex = allVideos.findIndex(v => v.id === videoId);
            if (videoIndex !== -1) {
                const video = allVideos[videoIndex];
                
                // Log activity
                logActivity(currentUser.id, currentUser.name, 'deleted a video', video.title);
                
                allVideos.splice(videoIndex, 1);
                showToast('Video deleted successfully');
                loadUserVideos();
                loadVideos();
                
                // Save data
                saveDataToStorage();
            }
        }
        
        // Update profile view
        function updateProfileView() {
            if (!currentUser) return;
            
            profileName.textContent = currentUser.name;
            profileEmail.textContent = currentUser.email;
            profilePicture.src = currentUser.avatar;
            profilePictureHeader.src = currentUser.avatar;
            
            updateProfileStats();
        }
        
        // Update profile statistics
        function updateProfileStats() {
            if (!currentUser) return;
            
            const userVideos = allVideos.filter(video => video.uploaderId === currentUser.id);
            const totalLikes = userVideos.reduce((sum, video) => sum + video.likes.length, 0);
            const totalViews = userVideos.reduce((sum, video) => sum + video.views, 0);
            
            profileVideos.textContent = userVideos.length;
            profileLikes.textContent = totalLikes;
            profileViews.textContent = totalViews;
        }
        
        // Show edit profile form
        function showEditProfileForm() {
            editName.value = currentUser.name;
            editAvatar.value = currentUser.avatar;
            profileEditForm.style.display = 'block';
            editProfileBtn.style.display = 'none';
        }
        
        // Hide edit profile form
        function hideEditProfileForm() {
            profileEditForm.style.display = 'none';
            editProfileBtn.style.display = 'block';
        }
        
        // Handle profile update
        function handleProfileUpdate(e) {
            e.preventDefault();
            
            const name = editName.value.trim();
            const avatar = editAvatar.value.trim();
            
            if (!name) {
                showToast('Please enter your name', true);
                return;
            }
            
            // Update user in allUsers array
            const userIndex = allUsers.findIndex(u => u.id === currentUser.id);
            if (userIndex !== -1) {
                allUsers[userIndex].name = name;
                if (avatar) allUsers[userIndex].avatar = avatar;
            }
            
            currentUser.name = name;
            if (avatar) currentUser.avatar = avatar;
            
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            
            // Update all videos with new user info
            allVideos.forEach(video => {
                if (video.uploaderId === currentUser.id) {
                    video.uploaderName = currentUser.name;
                    video.uploaderAvatar = currentUser.avatar;
                }
            });
            
            // Log activity
            logActivity(currentUser.id, currentUser.name, 'updated their profile', '');
            
            updateProfileView();
            hideEditProfileForm();
            loadVideos();
            showToast('Profile updated successfully');
            
            // Save data
            saveDataToStorage();
        }
        
        // Load admin dashboard
        function loadAdminDashboard() {
            // Update stats
            const totalUsers = allUsers.length;
            const totalVideos = allVideos.length;
            const totalViews = allVideos.reduce((sum, video) => sum + video.views, 0);
            const totalLikes = allVideos.reduce((sum, video) => sum + video.likes.length, 0);
            
            dashboardTotalUsers.textContent = totalUsers;
            dashboardTotalVideos.textContent = totalVideos;
            dashboardTotalViews.textContent = totalViews;
            dashboardTotalLikes.textContent = totalLikes;
            
            adminTotalUsers.textContent = totalUsers;
            adminTotalVideos.textContent = totalVideos;
            adminTotalViews.textContent = totalViews;
            
            // Load recent activity
            recentActivity.innerHTML = '';
            const recentActivities = [...activityLog].sort((a, b) => b.timestamp - a.timestamp).slice(0, 10);
            
            recentActivities.forEach(activity => {
                const row = document.createElement('tr');
                const date = new Date(activity.timestamp).toLocaleString();
                
                row.innerHTML = `
                    <td>${activity.userName}</td>
                    <td>${activity.action}</td>
                    <td>${activity.videoTitle || '-'}</td>
                    <td>${date}</td>
                `;
                
                recentActivity.appendChild(row);
            });
        }
        
        // Load admin videos
        function loadAdminVideos() {
            adminVideosTable.innerHTML = '';
            
            allVideos.forEach(video => {
                const row = document.createElement('tr');
                const date = new Date(video.timestamp).toLocaleDateString();
                
                row.innerHTML = `
                    <td>${video.title}</td>
                    <td>${video.uploaderName}</td>
                    <td>${video.views}</td>
                    <td>${video.likes.length}</td>
                    <td>${video.sponsored ? 'Yes' : 'No'}</td>
                    <td class="action-cell">
                        <button class="btn btn-warning btn-sm" onclick="toggleSponsor('${video.id}')">
                            ${video.sponsored ? 'Unsponsor' : 'Sponsor'}
                        </button>
                        <button class="btn btn-danger btn-sm" onclick="adminDeleteVideo('${video.id}')">
                            Delete
                        </button>
                    </td>
                `;
                
                adminVideosTable.appendChild(row);
            });
        }
        
        // Load admin users
        function loadAdminUsers() {
            adminUsersTable.innerHTML = '';
            
            allUsers.forEach(user => {
                const userVideos = allVideos.filter(video => video.uploaderId === user.id);
                const joinDate = new Date(user.joinDate).toLocaleDateString();
                
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <img src="${user.avatar}" alt="${user.name}" style="width: 30px; height: 30px; border-radius: 50%;">
                            <span>${user.name}</span>
                        </div>
                    </td>
                    <td>${user.email}</td>
                    <td>${userVideos.length}</td>
                    <td>${joinDate}</td>
                    <td>${user.role}</td>
                    <td class="action-cell">
                        <button class="btn btn-primary btn-sm" onclick="editUserName('${user.id}')">
                            Edit Name
                        </button>
                        ${user.role !== 'admin' ? `<button class="btn btn-warning btn-sm" onclick="makeAdmin('${user.id}')">Make Admin</button>` : ''}
                        ${user.role !== 'admin' ? `<button class="btn btn-danger btn-sm" onclick="deleteUser('${user.id}')">Delete</button>` : ''}
                    </td>
                `;
                
                adminUsersTable.appendChild(row);
            });
        }
        
        // Load sponsor videos
        function loadSponsorVideos() {
            sponsorVideosContainer.innerHTML = '';
            
            allVideos.forEach(video => {
                const videoCard = document.createElement('div');
                videoCard.className = 'video-card';
                
                videoCard.innerHTML = `
                    <div class="thumbnail-container">
                        <img class="thumbnail" src="${video.thumbnail}" alt="${video.title}" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIwIiBoZWlnaHQ9IjE4MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZTVlNWU1Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk5vIEltYWdlPC90ZXh0Pjwvc3ZnPg=='">
                        <div class="video-duration">${video.duration}</div>
                    </div>
                    <div class="video-content">
                        <h3 class="video-title">${escapeHTML(video.title)}</h3>
                        <div class="video-meta">
                            <span>${video.uploaderName}</span>
                            <span>${video.views} views</span>
                        </div>
                        <div class="video-actions">
                            <button class="btn ${video.sponsored ? 'btn-warning' : 'btn-success'}" onclick="toggleSponsor('${video.id}')">
                                ${video.sponsored ? 'Unsponsor' : 'Sponsor'}
                            </button>
                        </div>
                    </div>
                `;
                
                sponsorVideosContainer.appendChild(videoCard);
            });
        }
        
        // Toggle video sponsorship
        function toggleSponsor(videoId) {
            const video = allVideos.find(v => v.id === videoId);
            if (!video) return;
            
            video.sponsored = !video.sponsored;
            
            // Log activity
            logActivity(currentUser.id, currentUser.name, video.sponsored ? 'sponsored a video' : 'unsponsored a video', video.title);
            
            showToast(`Video ${video.sponsored ? 'sponsored' : 'unsponsored'} successfully`);
            
            // Update UI
            loadAdminVideos();
            loadSponsorVideos();
            
            // Save data
            saveDataToStorage();
        }
        
        // Admin delete video
        function adminDeleteVideo(videoId) {
            if (!confirm('Are you sure you want to delete this video?')) return;
            
            const videoIndex = allVideos.findIndex(v => v.id === videoId);
            if (videoIndex !== -1) {
                const video = allVideos[videoIndex];
                
                // Log activity
                logActivity(currentUser.id, currentUser.name, 'deleted a video (admin)', video.title);
                
                allVideos.splice(videoIndex, 1);
                showToast('Video deleted successfully');
                
                // Update UI
                loadAdminVideos();
                loadSponsorVideos();
                
                // Save data
                saveDataToStorage();
            }
        }
        
        // Edit user name
        function editUserName(userId) {
            const user = allUsers.find(u => u.id === userId);
            if (!user) return;
            
            const newName = prompt('Enter new name for user:', user.name);
            if (newName && newName.trim() !== '') {
                const oldName = user.name;
                user.name = newName.trim();
                
                // Update all videos with new user name
                allVideos.forEach(video => {
                    if (video.uploaderId === user.id) {
                        video.uploaderName = user.name;
                    }
                });
                
                // Log activity
                logActivity(currentUser.id, currentUser.name, `changed ${oldName}'s name to ${user.name}`, '');
                
                showToast('User name updated successfully');
                
                // Update UI
                loadAdminUsers();
                
                // Save data
                saveDataToStorage();
            }
        }
        
        // Make user admin
        function makeAdmin(userId) {
            const user = allUsers.find(u => u.id === userId);
            if (!user) return;
            
            if (confirm(`Are you sure you want to make ${user.name} an admin?`)) {
                user.role = 'admin';
                
                // Log activity
                logActivity(currentUser.id, currentUser.name, `made ${user.name} an admin`, '');
                
                showToast('User is now an admin');
                
                // Update UI
                loadAdminUsers();
                
                // Save data
                saveDataToStorage();
            }
        }
        
        // Delete user
        function deleteUser(userId) {
            const user = allUsers.find(u => u.id === userId);
            if (!user) return;
            
            if (confirm(`Are you sure you want to delete ${user.name}? This will also delete all their videos.`)) {
                // Delete user's videos
                allVideos = allVideos.filter(video => video.uploaderId !== userId);
                
                // Delete user
                allUsers = allUsers.filter(u => u.id !== userId);
                
                // Log activity
                logActivity(currentUser.id, currentUser.name, `deleted user ${user.name}`, '');
                
                showToast('User deleted successfully');
                
                // Update UI
                loadAdminUsers();
                loadAdminVideos();
                loadSponsorVideos();
                loadAdminDashboard();
                
                // Save data
                saveDataToStorage();
            }
        }
        
        // Log activity
        function logActivity(userId, userName, action, videoTitle) {
            const activity = {
                id: generateId(),
                userId: userId,
                userName: userName,
                action: action,
                videoTitle: videoTitle,
                timestamp: Date.now()
            };
            
            activityLog.unshift(activity);
            
            // Keep only the last 100 activities
            if (activityLog.length > 100) {
                activityLog.splice(100);
            }
            
            // Save data
            saveDataToStorage();
        }
        
        // Clear form
        function clearForm() {
            uploadForm.reset();
            showToast('Form cleared');
        }
        
        // Show toast notification
        function showToast(message, isError = false, isWarning = false) {
            toastMessage.textContent = message;
            
            if (isError) {
                toast.classList.add('error');
                toast.classList.remove('warning');
            } else if (isWarning) {
                toast.classList.add('warning');
                toast.classList.remove('error');
            } else {
                toast.classList.remove('error', 'warning');
            }
            
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // Utility function to escape HTML
        function escapeHTML(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // Generate a unique ID
        function generateId() {
            return 'id_' + Math.random().toString(36).substr(2, 9);
        }
        
        // Make functions available globally for onclick handlers
        window.handleLike = handleLike;
        window.handleSave = handleSave;
        window.deleteVideo = deleteVideo;
        window.toggleSponsor = toggleSponsor;
        window.adminDeleteVideo = adminDeleteVideo;
        window.editUserName = editUserName;
        window.makeAdmin = makeAdmin;
        window.deleteUser = deleteUser;
    </script>
</body>
</html>